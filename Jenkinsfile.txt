pipeline {
    agent any
    stages {
        stage('Chmod') {
            steps {
                sh 'chmod +x gradlew'
            }
        }
        stage('Test') {
          steps {
            sh './gradlew clean test --no-daemon'
          }
        }
        stage('Build Allure') {
          steps {
            sh './gradlew allureServe'
          }
        }
        stage('Allure Serve') {
          steps {
            allure([
            includeProperties: false,
            jdk: '',
            properties: [],
            reportBuildPolicy: 'ALWAYS',
            results: [[path: 'target/allure-results']]
            ])
          }
        }
    }
}